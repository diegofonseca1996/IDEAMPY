import pandas as pd
import matplotlib as plt
import numpy as np


#Abrir CSV
tabla = pd.read_csv('DFONSECA2911.csv')
df = pd.DataFrame(tabla)
df.reset_index(inplace=True)

#Dividir fechas
df[['date','hour']] = df['Fecha'].str.split(' ',expand=True)
df[['Year','Month','Day']] = df['date'].str.split('-',expand=True)

#Listas de datos
df.reset_index(inplace=True)
years = df.Year.unique()
months = df.Month.unique()
days = df.Day.unique()
stations = df.NombreEstacion.unique()
data = df[['NombreEstacion','Etiqueta','Valor','Day','Month','Year','Longitud','Latitud','Altitud']]
valores = df.Valor
serie_val = pd.Series(valores)


#series
serie_est = pd.Series(stations)
duplic_est = pd.Series(np.repeat(serie_est.values, len(years)*12))
serie_year = pd.Series(years)
duplic_year = pd.Series(np.repeat(serie_year.values,12))
helpme = duplic_year.to_list()
list_mes=[]
for i in range (len(years)*len(stations)):
    copia = months.copy()
    list_mes.extend(copia)
serie_mes = pd.Series(list_mes)

while len(helpme) < len(duplic_est):
    copy2 = helpme.copy()
    helpme.extend(copy2)

fi_he = pd.Series(helpme)

#New Series
s_est_num = pd.Series(stations)
s_month_num = pd.Series(months)
s_year_num = pd.Series(years)


#new df
info_ndf = {'Estacion':duplic_est,'Year':fi_he,'Mes':serie_mes}
ndf= pd.DataFrame(info_ndf)
nndf = ndf[ndf['Estacion'].notna()]
nndf.reset_index(drop=True)

print(nndf)
